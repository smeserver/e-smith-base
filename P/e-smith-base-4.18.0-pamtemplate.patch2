diff -Nur -x '*.orig' -x '*.rej' e-smith-base-4.18.0/root/etc/e-smith/templates/etc/pam.d/proftpd/20auth mezzanine_patched_e-smith-base-4.18.0/root/etc/e-smith/templates/etc/pam.d/proftpd/20auth
--- e-smith-base-4.18.0/root/etc/e-smith/templates/etc/pam.d/proftpd/20auth	2007-03-19 16:18:37.000000000 -0600
+++ mezzanine_patched_e-smith-base-4.18.0/root/etc/e-smith/templates/etc/pam.d/proftpd/20auth	2007-03-19 16:17:57.000000000 -0600
@@ -1 +1,2 @@
 auth       { -f "/lib/security/pam_pwdb.so" ? "required     pam_stack.so service=system-auth" : "include     system-auth" }
+auth       required     pam_shells.so
diff -Nur -x '*.orig' -x '*.rej' e-smith-base-4.18.0/root/etc/e-smith/templates/etc/pam.d/pwauth/20auth mezzanine_patched_e-smith-base-4.18.0/root/etc/e-smith/templates/etc/pam.d/pwauth/20auth
--- e-smith-base-4.18.0/root/etc/e-smith/templates/etc/pam.d/pwauth/20auth	2007-03-19 16:18:37.000000000 -0600
+++ mezzanine_patched_e-smith-base-4.18.0/root/etc/e-smith/templates/etc/pam.d/pwauth/20auth	2007-03-19 16:18:19.000000000 -0600
@@ -1 +1,2 @@
 auth       { -f "/lib/security/pam_pwdb.so" ? "required     pam_stack.so service=system-auth" : "include     system-auth" }
+auth       required     /lib/security/pam_nologin.so
