Index: e-smith-base/e-smith-base.spec
diff -u /dev/null e-smith-base/root/etc/e-smith/db/configuration/defaults/httpd-admin/TCPPort:1.1
--- /dev/null	Tue Aug  2 16:41:03 2005
+++ e-smith-base/root/etc/e-smith/db/configuration/defaults/httpd-admin/TCPPort	Tue Aug  2 16:37:37 2005
@@ -0,0 +1 @@
+980
Index: e-smith-base/root/etc/e-smith/db/configuration/defaults/httpd-admin/access
diff -u /dev/null e-smith-base/root/etc/e-smith/db/configuration/defaults/httpd-admin/access:1.1
--- /dev/null	Tue Aug  2 16:41:03 2005
+++ e-smith-base/root/etc/e-smith/db/configuration/defaults/httpd-admin/access	Tue Aug  2 16:37:38 2005
@@ -0,0 +1 @@
+local
Index: e-smith-base/root/etc/e-smith/templates/etc/httpd/admin-conf/httpd.conf/20Manager
diff -u e-smith-base/root/etc/e-smith/templates/etc/httpd/admin-conf/httpd.conf/20Manager:1.11 e-smith-base/root/etc/e-smith/templates/etc/httpd/admin-conf/httpd.conf/20Manager:1.12
--- e-smith-base/root/etc/e-smith/templates/etc/httpd/admin-conf/httpd.conf/20Manager:1.11	Tue Jun  7 11:32:56 2005
+++ e-smith-base/root/etc/e-smith/templates/etc/httpd/admin-conf/httpd.conf/20Manager	Tue Aug  2 16:37:38 2005
@@ -1,5 +1,5 @@
 {
-    $OUT .= "Listen 127.0.0.1:980\n";
+    $OUT .= "Listen 127.0.0.1:${'httpd-admin'}{TCPPort}\n";
 
     $OUT .= <<HERE;
 
Index: e-smith-base/root/etc/e-smith/templates/etc/services/20http-admin
diff -u e-smith-base/root/etc/e-smith/templates/etc/services/20http-admin:1.1.1.1 e-smith-base/root/etc/e-smith/templates/etc/services/20http-admin:1.2
--- e-smith-base/root/etc/e-smith/templates/etc/services/20http-admin:1.1.1.1	Fri Feb 15 14:31:21 2002
+++ e-smith-base/root/etc/e-smith/templates/etc/services/20http-admin	Tue Aug  2 16:37:38 2005
@@ -1 +1 @@
-http-admin	980/tcp		# admin HTTP server
+http-admin	{ ${'httpd-admin'}{TCPPort} }/tcp		# admin HTTP server
Index: e-smith-base/root/sbin/e-smith/console
diff -u e-smith-base/root/sbin/e-smith/console:1.158 e-smith-base/root/sbin/e-smith/console:1.159
--- e-smith-base/root/sbin/e-smith/console:1.158	Wed Jul 27 14:38:37 2005
+++ e-smith-base/root/sbin/e-smith/console	Tue Aug  2 16:37:38 2005
@@ -65,7 +65,7 @@
 
         return undef if ($self->EXISTS($key) and $self->FETCH($key) eq $value);
 
-        if (($self->filename eq 'configuration')
+        if (($self->filename =~ m#(^|/)configuration$#)
             && ($key ne 'UnsavedChanges')) {
             $self->SUPER::STORE('UnsavedChanges', 'yes');
         }
