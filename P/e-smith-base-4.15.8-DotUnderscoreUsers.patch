diff -Nur -x '*.orig' -x '*.rej' e-smith-base-4.15.8/root/etc/e-smith/db/configuration/defaults/maxAcctNameLength/type mezzanine_patched_e-smith-base-4.15.8/root/etc/e-smith/db/configuration/defaults/maxAcctNameLength/type
--- e-smith-base-4.15.8/root/etc/e-smith/db/configuration/defaults/maxAcctNameLength/type	1970-01-01 10:00:00.000000000 +1000
+++ mezzanine_patched_e-smith-base-4.15.8/root/etc/e-smith/db/configuration/defaults/maxAcctNameLength/type	2006-01-09 14:43:51.232516970 +1100
@@ -0,0 +1 @@
+31
diff -Nur -x '*.orig' -x '*.rej' e-smith-base-4.15.8/root/etc/e-smith/db/configuration/defaults/maxGroupNameLength/type mezzanine_patched_e-smith-base-4.15.8/root/etc/e-smith/db/configuration/defaults/maxGroupNameLength/type
--- e-smith-base-4.15.8/root/etc/e-smith/db/configuration/defaults/maxGroupNameLength/type	1970-01-01 10:00:00.000000000 +1000
+++ mezzanine_patched_e-smith-base-4.15.8/root/etc/e-smith/db/configuration/defaults/maxGroupNameLength/type	2006-01-09 14:44:09.262379976 +1100
@@ -0,0 +1 @@
+31
diff -Nur -x '*.orig' -x '*.rej' e-smith-base-4.15.8/root/usr/lib/perl5/site_perl/esmith/FormMagick/Panel/useraccounts.pm mezzanine_patched_e-smith-base-4.15.8/root/usr/lib/perl5/site_perl/esmith/FormMagick/Panel/useraccounts.pm
--- e-smith-base-4.15.8/root/usr/lib/perl5/site_perl/esmith/FormMagick/Panel/useraccounts.pm	2005-11-21 15:28:11.000000000 +1100
+++ mezzanine_patched_e-smith-base-4.15.8/root/usr/lib/perl5/site_perl/esmith/FormMagick/Panel/useraccounts.pm	2006-01-09 14:48:18.010100668 +1100
@@ -3,7 +3,7 @@
 #----------------------------------------------------------------------
 # $Id: useraccounts.pm,v 1.108 2004/11/11 20:05:56 charlieb Exp $
 #----------------------------------------------------------------------
-# copyright (C) 1999-2003 Mitel Networks Corporation
+# copyright (C) 1999-2006 Mitel Networks Corporation
 # 
 # This program is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
@@ -18,9 +18,6 @@
 # You should have received a copy of the GNU General Public License
 # along with this program; if not, write to the Free Software
 # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307  USA
-# 
-# Technical support for this program is available from Mitel Networks 
-# Please visit our web site www.mitel.com/sme/ for details.
 #----------------------------------------------------------------------
 package    esmith::FormMagick::Panel::useraccounts;
 
@@ -730,7 +727,7 @@
     my ($self) = @_;
     my $acctName = $self->{cgi}->param('acctName');
 
-    unless (($acctName) = ($acctName =~ /^(\w[\-\w]+)$/)) {
+    unless (($acctName) = ($acctName =~ /^(\w[\-\w_\.]+)$/)) {
         return $self->error($self->localise('TAINTED_USER',
             { acctName => $acctName }));
     }
@@ -825,7 +822,7 @@
     undef $accountdb;
 
     # Untaint the username before use in system()
-    $acctName =~ /^(\w[\-\w]+)$/;
+    $acctName =~ /^(\w[\-\w_\.]+)$/;
     $acctName = $1;
 
     if (system ("/sbin/e-smith/signal-event", "user-create", $acctName)) 
@@ -875,7 +872,7 @@
         undef $accountdb;
 
 	# Untaint the username before use in system()
-	$acctName =~ /^(\w[\-\w]+)$/;
+	$acctName =~ /^(\w[\-\w_\.]+)$/;
 	$acctName = $1;
         if (system ("/sbin/e-smith/signal-event", "user-delete", $acctName))
         {
@@ -950,7 +947,7 @@
         undef $accountdb;
 
 	# Untaint the username before use in system()
-	$acctName =~ /^(\w[\-\w]+)$/;
+	$acctName =~ /^(\w[\-\w_\.]+)$/;
 	$acctName = $1;
         if (system("/sbin/e-smith/signal-event", "user-lock", $acctName))
         {
